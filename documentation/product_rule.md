# Mini Social App – Product & Backend Rules Guide

(This Challenge is generated by ChatGPT)

## App Screens

This app has 4 screens:

- Login
- Register
- Feed (posts)
- Profile

But the rules below are mandatory.
These rules are what make it not CRUD-only.

## 1. Authentication Rules

- Users must log in to do anything except register
- Every request (except login/register) requires a token
- Token identifies the user, not request body

**Backend must:**

- Reject requests without token
- Never accept userId from client

## 2. User & Profile Rules

- Every user has exactly one profile
- Profile is auto-created on register

**Profile contains:**

- avatar
- thumbnail
- bio

**Rules:**

- User can only update their own profile
- User cannot update someone else's profile
- Updating avatar replaces the old one
- Thumbnail is auto-generated from avatar
- Old avatar and thumbnail files must be deleted

## 3. Post Creation Rules

- Only logged-in users can create posts
- Post always belongs to the logged-in user

**Post may contain:**

- rich text (Quill)
- optional image

**Rules:**

- Post author is determined by token, not request
- Image must be:
  - image type only
  - limited size
- Invalid image → request rejected

## 4. Post Ownership Rules

**Only post owner can:**

- delete their post

- Admin (optional) can delete any post

**Rules:**

- If user tries to delete someone else's post → reject
- Do not hide this logic in frontend
- Backend must enforce this

## 5. Feed Rules (IMPORTANT)

- Feed is not "get all posts"
- Feed is ordered by newest first
- Feed is paginated

**Rules:**

- Client requests limited number of posts
- Backend returns:
  - list of posts
  - next cursor
- Deleted posts never appear in feed

## 6. Delete Rules (Soft Delete)

- Posts are not removed from database
- Deleted posts are marked as deleted

**Rules:**

- Normal users never see deleted posts
- Deleted posts still exist in DB
- Delete action changes state, not data existence

## 7. File Handling Rules

- Images are real files, not strings
- Files belong to something (user or post)

**Rules:**

- Delete post → delete post image
- Update avatar → delete old avatar and thumbnail
- Thumbnail is auto-generated when avatar is uploaded
- No orphan files allowed

## 8. Rich Text Rules (flutter_quill)

- Post content is structured data
- Do not store plain text only

**Rules:**

- Store Quill output as JSON
- Backend accepts only valid structure
- Backend does not trust frontend formatting

## 9. Error Rules

Backend must respond clearly.

**Rules:**

- Not logged in → 401
- Logged in but not allowed → 403
- Invalid input → 422
- Duplicate data → 409

Frontend must not guess errors.

## 10. Rate Limiting Rules

Prevent abuse.

**Rules:**

- Limit post creation per user
- Limit login attempts
- Reject excess requests

## 11. Security Rules

- Client never decides ownership
- Client never decides identity
- Client never decides permissions
- Backend decides everything

## 12. API Design Rules

- Use versioned API
- Consistent response format
- No hidden side effects

## What This App IS

✅ A feed system
✅ With identity
✅ With ownership
✅ With file lifecycle
✅ With clear rules
